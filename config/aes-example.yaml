---
# Server configuration
bind_address: "0.0.0.0:8080"
log_level: "info"
log_health_requests: false  # Disable health endpoint logging by default

# S3 backend configuration
target_endpoint: "https://minio:9000"
region: "us-east-1"
access_key_id: "minioadmin"
secret_key: "minioadmin123"
use_tls: true
skip_ssl_verification: true

# Multi-Provider Encryption Configuration
encryption:
  # Active encryption method (used for writing new files) - CORRECTED ARCHITECTURE!
  encryption_method_alias: "aes-envelope"

  # List of KEK providers (correct architecture)
  providers:
    - alias: "aes-envelope"
      type: "aes"
      description: "AES envelope encryption (auto-selects AES-CTR for multipart, AES-GCM for whole files)"
      config:
        # Generate a demo key (do NOT use in production!)
        aes_key: "XZmcGLpObUuGV8CFOmfLKs7rggrX2TwIk5/Lbt9Azl4="

# Performance Optimizations Configuration
optimizations:
  # Streaming buffer size for chunk-wise processing (4KB - 2MB)
  # Default: 64KB (65536 bytes)
  # Higher values: Better throughput for large files, more memory usage
  # Lower values: Better for memory-constrained environments, more CPU overhead
  streaming_buffer_size: 65536  # 64KB

  # Streaming segment size for multipart uploads (5MB - 5GB)
  # Default: 12MB (12582912 bytes)
  # This defines how much data is collected before sending as one S3 upload part
  streaming_segment_size: 12582912  # 12MB = 12 * 1024 * 1024 bytes

  # Enable adaptive buffering based on system load (experimental)
  # When enabled, buffer sizes adjust dynamically
  enable_adaptive_buffering: false

  # Thresholds for processing strategy selection (when adaptive buffering is enabled)
  # Files smaller than force_traditional_threshold use traditional processing
  force_traditional_threshold: 1048576  # 1MB

  # Files larger than streaming_threshold always use streaming
  streaming_threshold: 5242880  # 5MB
