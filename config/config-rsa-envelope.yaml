# S3 Encryption Proxy Configuration Example - RSA Envelope Encryption

# Server configuration
bind_address: "0.0.0.0:8080"
log_level: "info"

# S3 backend configuration
target_endpoint: "https://s3.amazonaws.com"
region: "us-east-1"
access_key_id: "${S3_ACCESS_KEY_ID}"
secret_key: "${S3_SECRET_KEY}"

# RSA Envelope Encryption Configuration
encryption:
  # Active encryption method (used for writing new files)
  encryption_method_alias: "rsa-envelope"

  # List of encryption providers (used for reading/decrypting files)
  providers:
    - alias: "rsa-envelope"
      type: "rsa"
      description: "RSA envelope encryption (auto-selects AES-CTR for multipart, AES-GCM for whole files)"
      config:
        # RSA public key in PEM format (can be shared safely)
        # Generate with: go run cmd/rsa-keygen/main.go
        public_key_pem: |
          -----BEGIN PUBLIC KEY-----
          MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA1234567890abcdef...
          ...your RSA public key here...
          -----END PUBLIC KEY-----

        # RSA private key in PEM format (keep secure!)
        # This should be stored securely and loaded from environment variables
        private_key_pem: "${RSA_PRIVATE_KEY}"

        # Key size for validation (optional)
        key_size: 2048

        # Metadata configuration
        algorithm: "RSA_ENVELOPE"
        metadata_key_prefix: "s3ep-rsa-"

    # Fallback to AES-GCM for compatibility
    - alias: "legacy-aes"
      type: "aes-gcm"
      description: "Legacy AES-256-GCM encryption"
      config:
        aes_key: "${LEGACY_AES_KEY}"
        algorithm: "AES256_GCM"
        metadata_key_prefix: "s3ep-"

    # Optional: No encryption for testing
    - alias: "none"
      type: "none"
      description: "No encryption (testing only)"
      config: {}
